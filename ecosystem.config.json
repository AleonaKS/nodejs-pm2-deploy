{
  "apps": [
    {
      "name": "backend",
      "script": "./dist/app.js",
      "cwd": "/home/user/nodejs-pm2-deploy/backend",
      "env": {
        "NODE_ENV": "production",
        "PORT": 3000
      }
    },
    {
      "name": "frontend",
      "script": "serve",
      "args": ["-s", "build", "-l", "3001"],
      "cwd": "/home/user/nodejs-pm2-deploy/frontend",
      "env": {
        "PM2_SERVE_PORT": 3001
      }
    }
  ],
  "deploy": {
    "production": {
      "user": "user",
      "host": ["158.160.210.113"],
      "ref": "origin/main",
      "repo": "git@github.com:alenasenozenskaya/nodejs-pm2-deploy.git",
      "path": "/home/user/nodejs-pm2-deploy",
      "pre-deploy": "git fetch --all",
      "post-deploy": "cd backend && npm ci && npm run build && cp /home/user/nodejs-pm2-deploy/backend/.env /home/user/nodejs-pm2-deploy/backend/.env && cd ../frontend && npm ci && npm run build && pm2 reload ecosystem.config.json --env production",
      "env": {
        "NODE_ENV": "production"
      }
    }
  }
}
